<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crawler Configuration</title>
    <link rel="stylesheet" href="/dashboard/new.css">
    <link rel="stylesheet" href="/dashboard/base.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><a href="{{ url_for('homepage') }}" data-tooltip="Home"><i class="fa-regular fa-house"></i></a></li>
                    <li><a href="{{ url_for('leaks') }}" data-tooltip="Leaks"><i class="fa-solid fa-spider"></i></a></li>
                    <li><a href="{{ url_for('alerts') }}" data-tooltip="Alerts"><i class="fa-regular fa-bell"></i></a></li>
                    <li><a href="{{ url_for('dashboard') }}" data-tooltip="Dashboard"><i class="fa-regular fa-chart-bar"></i></a></li>
                    <li><a href="{{ url_for('reports') }}" data-tooltip="Reports"><i class="fa-regular fa-file-lines"></i></a></li>
                    <li><a class="active" href="{{ url_for('config') }}" data-tooltip="Settings"><i class="fa-solid fa-gear"></i></a></li>
                    <li><a href="{{ url_for('resources_route') }}" data-tooltip="Resources"><i class="fa-regular fa-file"></i></a></li>
                    <li><a href="{{ url_for('account') }}" data-tooltip="Account"><i class="fa-regular fa-circle-user"></i></a></li>
                </ul>
            </nav>
        </aside>
        <main>
            <div class="section-heading">
                <h2>Crawler Configuration</h2>
            </div>
            
            <section id="config">
                <!-- Tabs for different config sections -->
                <div class="tabs" style="margin-bottom: 20px;">
                    <button class="tab-btn active" data-tab="watchlist-tab">Watchlist</button>
                    <button class="tab-btn" data-tab="crawlers-tab">Crawlers</button>
                    <button class="tab-btn" data-tab="alerts-tab">Alerts</button>
                </div>

                <!-- Watchlist Configuration -->
                <div id="watchlist-tab" class="tab-content active">
                    <section class="dashboard-item">
                        <h3>Watchlist Configuration</h3>
                        <p class="muted" style="margin-bottom: 16px;">
                            Define your organization's critical assets to monitor. Sensitive data (SSNs, passwords, etc.) will be automatically hashed for security.
                        </p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <!-- Non-sensitive entities -->
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-solid fa-globe"></i> Domains
                                </label>
                                <textarea id="watchlistDomains" class="input-wide" rows="3" 
                                    placeholder="example.com, test.org, mycompany.com"
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated domain names</small>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-solid fa-envelope"></i> Email Addresses
                                </label>
                                <textarea id="watchlistEmails" class="input-wide" rows="3" 
                                    placeholder="admin@example.com, security@company.com"
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated email addresses</small>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-solid fa-network-wired"></i> IP Addresses
                                </label>
                                <textarea id="watchlistIPs" class="input-wide" rows="3" 
                                    placeholder="192.168.1.1, 10.0.0.1"
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated IP addresses</small>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-brands fa-bitcoin"></i> Bitcoin Wallets
                                </label>
                                <textarea id="watchlistBTC" class="input-wide" rows="3" 
                                    placeholder="bc1qxyz..., 1A1zP1eP5..."
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated Bitcoin addresses</small>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-solid fa-user"></i> Names
                                </label>
                                <textarea id="watchlistNames" class="input-wide" rows="3" 
                                    placeholder="John Doe, Jane Smith"
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated full names (auto-hashed)</small>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                    <i class="fa-solid fa-magnifying-glass"></i> Keywords
                                </label>
                                <textarea id="watchlistKeywords" class="input-wide" rows="3" 
                                    placeholder="password, login, credentials, breach"
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                                <small class="muted">Comma-separated search terms</small>
                            </div>
                        </div>
                        
                        <!-- Sensitive data section -->
                        <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #3D4754;">
                            <h4 style="color: #FF9800; margin-bottom: 12px;">
                                <i class="fa-solid fa-shield-halved"></i> Sensitive Data (Stored Hashed)
                            </h4>
                            <p class="muted" style="margin-bottom: 16px;">
                                The following fields will be automatically hashed (SHA-256) before storage for security. We'll still be able to detect matches.
                            </p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                        <i class="fa-solid fa-id-card"></i> Social Security Numbers
                                    </label>
                                    <textarea id="watchlistSSNs" class="input-wide" rows="3" 
                                        placeholder="123-45-6789, 987-65-4321, 111-22-3333 (comma-separated)"
                                        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #FF9800; background: #1a1d23; color: #fff;"></textarea>
                                    <small style="color: #FF9800;">⚠ Auto-hashed for security. Enter multiple values separated by commas.</small>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                        <i class="fa-solid fa-key"></i> Passwords
                                    </label>
                                    <textarea id="watchlistPasswords" class="input-wide" rows="3" 
                                        placeholder="password123, MySecurePass!, SecretPass456 (comma-separated)"
                                        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #FF9800; background: #1a1d23; color: #fff;"></textarea>
                                    <small style="color: #FF9800;">⚠ Auto-hashed for security. Enter multiple values separated by commas.</small>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                        <i class="fa-solid fa-phone"></i> Phone Numbers
                                    </label>
                                    <textarea id="watchlistPhones" class="input-wide" rows="3" 
                                        placeholder="555-123-4567, (555) 987-6543, 555-111-2222 (comma-separated)"
                                        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #FF9800; background: #1a1d23; color: #fff;"></textarea>
                                    <small style="color: #FF9800;">⚠ Auto-hashed for security. Enter multiple values separated by commas.</small>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 6px; font-weight: 600;">
                                        <i class="fa-solid fa-location-dot"></i> Physical Addresses
                                    </label>
                                    <textarea id="watchlistAddresses" class="input-wide" rows="3" 
                                        placeholder="123 Main St Anytown CA 12345, 456 Oak Ave Springfield IL 62701 (comma-separated)"
                                        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #FF9800; background: #1a1d23; color: #fff;"></textarea>
                                    <small style="color: #FF9800;">⚠ Auto-hashed for security. Enter multiple values separated by commas.</small>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Crawler Configuration -->
                <div id="crawlers-tab" class="tab-content">
                    <!-- Pastebin Config -->
                    <section class="dashboard-item" style="margin-bottom: 20px;">
                        <h3><i class="fa-solid fa-clipboard" style="margin-right: 8px;"></i>Pastebin</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 12px;">
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Limit</label>
                                <input type="number" id="pastebinLimit" class="input-compact" min="1" max="100" value="5" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Max pastes to fetch per run</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Rate Limit (ms)</label>
                                <input type="number" id="pastebinRateLimit" class="input-compact" min="0" max="5000" value="500" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Wait time between requests</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Timeout (sec)</label>
                                <input type="number" id="pastebinTimeout" class="input-compact" min="5" max="60" value="15" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Request timeout</small>
                            </div>
                        </div>
                        
                        <!-- Pastebin How It Works -->
                        <div style="background: #1a1d23; border-left: 3px solid #4a9eff; padding: 12px 16px; margin-top: 16px; border-radius: 4px;">
                            <h4 style="margin: 0 0 8px 0; color: #4a9eff; font-size: 14px;"><i class="fa-solid fa-info-circle" style="margin-right: 6px;"></i>How Pastebin Crawler Works</h4>
                            <div style="font-size: 13px; line-height: 1.6; color: #b8bcc4;">
                                <p style="margin: 6px 0;"><strong>Data Collection Method:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li>Fetches the public Pastebin archive page (pastebin.com/archive)</li>
                                    <li>Extracts recent paste links from the archive table</li>
                                    <li>Visits each paste URL to retrieve full content</li>
                                    <li>Respects rate limits between requests (configurable delay)</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Data Extracted:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Paste Content:</strong> Full text from paste_code textarea or source div</li>
                                    <li><strong>Metadata:</strong> Title, paste ID, poster username (if available), URL</li>
                                    <li><strong>Entities:</strong> SSNs, emails, passwords, phone numbers, physical addresses, credit cards</li>
                                    <li><strong>Language:</strong> Detected programming/natural language of content</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Classification Process:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Entity Extraction:</strong> Scans content using regex patterns for sensitive data (SSN, emails, passwords, etc.)</li>
                                    <li><strong>Asset Matching:</strong> Compares extracted entities against your configured watchlist (names, SSNs, phones, addresses)</li>
                                    <li><strong>Threat Typing:</strong> Classifies as "credential_dump" if keywords like "combo list", "password", "leak" are present; otherwise "generic_paste"</li>
                                    <li><strong>Severity Scoring:</strong> Calculates severity based on entity types and asset matches (critical → high → medium → low → zero)</li>
                                    <li><strong>Confidence Rating:</strong> High confidence (0.9) if asset matches found, lower (0.4) otherwise</li>
                                    <li><strong>Deduplication:</strong> Uses SHA-256 hash of content to prevent storing duplicate pastes</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Best Use Cases:</strong> Monitoring for leaked credentials, combo lists, database dumps, and publicly posted sensitive information</p>
                            </div>
                        </div>
                    </section>

                    <!-- Tor Config -->
                    <section class="dashboard-item" style="margin-bottom: 20px;">
                        <h3><i class="fa-solid fa-user-secret" style="margin-right: 8px;"></i>Tor</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 12px;">
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">SOCKS Port</label>
                                <input type="number" id="torPort" class="input-compact" min="1024" max="65535" value="9050" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Tor proxy port (9050 or 9150)</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Timeout (sec)</label>
                                <input type="number" id="torTimeout" class="input-compact" min="10" max="120" value="40" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Request timeout (Tor is slow)</small>
                            </div>
                        </div>
                        <div style="margin-top: 12px;">
                            <label style="display: block; margin-bottom: 6px; font-weight: 600;">Keywords (comma-separated)</label>
                            <textarea id="torKeywords" rows="2" 
                                placeholder="dump, breach, login, database, leak"
                                style="width: 100%; max-width: 600px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                        </div>
                        
                        <!-- Tor How It Works -->
                        <div style="background: #1a1d23; border-left: 3px solid #7851a9; padding: 12px 16px; margin-top: 16px; border-radius: 4px;">
                            <h4 style="margin: 0 0 8px 0; color: #9370db; font-size: 14px;"><i class="fa-solid fa-info-circle" style="margin-right: 6px;"></i>How Tor Crawler Works</h4>
                            <div style="font-size: 13px; line-height: 1.6; color: #b8bcc4;">
                                <p style="margin: 6px 0;"><strong>Data Collection Method:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li>Routes requests through Tor SOCKS5 proxy (127.0.0.1:9050 or 9150)</li>
                                    <li>Fetches .onion hidden service URLs you provide</li>
                                    <li>Uses BeautifulSoup to parse HTML content</li>
                                    <li>Implements retry logic with configurable delays for unreliable Tor connections</li>
                                    <li>Performs health check against DuckDuckGo onion service before crawling</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Data Extracted:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Page Content:</strong> Full text extracted from HTML body</li>
                                    <li><strong>Title:</strong> Page title from &lt;title&gt; tag</li>
                                    <li><strong>Entities:</strong> SSNs, names, emails, passwords, phone numbers, physical addresses extracted via regex</li>
                                    <li><strong>Language:</strong> Automatically detected from content</li>
                                    <li><strong>Tags:</strong> Auto-generated based on entity types and content patterns</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Classification Process:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Entity Extraction:</strong> Regex-based pattern matching for SSNs, emails, passwords, phone numbers, addresses, names</li>
                                    <li><strong>Asset Matching:</strong> Cross-references extracted entities with your watchlist configuration</li>
                                    <li><strong>Tag Generation:</strong> Automatically assigns tags based on detected entity types and matched assets</li>
                                    <li><strong>Severity Computation:</strong> Uses entity-based scoring algorithm (compute_severity_from_entities)</li>
                                    <li><strong>Content Redaction:</strong> Sensitive data is redacted before storage for security</li>
                                    <li><strong>Fingerprinting:</strong> SHA-256 hash of content prevents duplicate storage</li>
                                    <li><strong>Event API:</strong> Sends structured event payload to backend API for centralized tracking</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Requirements:</strong> Local Tor instance running (Tor Browser on port 9150 or Tor service on port 9050)</p>
                                <p style="margin: 6px 0;"><strong>Best Use Cases:</strong> Monitoring dark web marketplaces, forums, paste sites for leaked credentials and sensitive data exposure</p>
                            </div>
                        </div>
                    </section>

                    <!-- I2P Config -->
                    <section class="dashboard-item" style="margin-bottom: 20px;">
                        <h3><i class="fa-solid fa-network-wired" style="margin-right: 8px;"></i>I2P</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 12px;">
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Proxy Host</label>
                                <input type="text" id="i2pHost" class="input-wide" value="127.0.0.1" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Proxy Port</label>
                                <input type="number" id="i2pPort" class="input-compact" min="1024" max="65535" value="4444" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Timeout (sec)</label>
                                <input type="number" id="i2pTimeout" class="input-compact" min="10" max="120" value="40" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                            </div>
                        </div>
                        <div style="margin-top: 12px;">
                            <label style="display: block; margin-bottom: 6px; font-weight: 600;">Keywords (comma-separated)</label>
                            <textarea id="i2pKeywords" rows="2" 
                                placeholder="credential, compromised, breach, account"
                                style="width: 100%; max-width: 600px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                        </div>
                        
                        <!-- I2P How It Works -->
                        <div style="background: #1a1d23; border-left: 3px solid #e74c3c; padding: 12px 16px; margin-top: 16px; border-radius: 4px;">
                            <h4 style="margin: 0 0 8px 0; color: #e74c3c; font-size: 14px;"><i class="fa-solid fa-info-circle" style="margin-right: 6px;"></i>How I2P Crawler Works</h4>
                            <div style="font-size: 13px; line-height: 1.6; color: #b8bcc4;">
                                <p style="margin: 6px 0;"><strong>Data Collection Method:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li>Routes requests through I2P HTTP proxy (127.0.0.1:4444)</li>
                                    <li>Fetches .i2p eepsites (I2P hidden services) you specify</li>
                                    <li>Uses BeautifulSoup for HTML parsing and text extraction</li>
                                    <li>Implements retry mechanism with delays for connection reliability</li>
                                    <li>Health check validates I2P connectivity via zzz.i2p before crawling</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Data Extracted:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Page Content:</strong> Full plaintext extracted from HTML</li>
                                    <li><strong>Page Title:</strong> Extracted from &lt;title&gt; element</li>
                                    <li><strong>Entities:</strong> SSNs, names, emails, passwords, phone numbers, physical addresses</li>
                                    <li><strong>Language Detection:</strong> Automatically identifies content language</li>
                                    <li><strong>Metadata:</strong> URL, content hash, timestamp</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Classification Process:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Entity Extraction:</strong> Regex patterns identify sensitive data types (SSN, email, phone, etc.)</li>
                                    <li><strong>Watchlist Matching:</strong> Compares entities against configured watchlist assets</li>
                                    <li><strong>Auto-Tagging:</strong> Generates tags based on entity types and asset matches</li>
                                    <li><strong>Severity Scoring:</strong> Computes severity level based on entity sensitivity and quantity</li>
                                    <li><strong>Redaction:</strong> Sensitive information is redacted for safe storage</li>
                                    <li><strong>Deduplication:</strong> SHA-256 content hash prevents duplicate leak entries</li>
                                    <li><strong>API Integration:</strong> Sends event payload with redacted content to backend API</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Requirements:</strong> I2P router running locally with HTTP proxy on port 4444</p>
                                <p style="margin: 6px 0;"><strong>Best Use Cases:</strong> Monitoring I2P eepsites for data leaks, credential dumps, and sensitive information exposure on the Invisible Internet</p>
                            </div>
                        </div>
                    </section>

                    <!-- GitHub Config -->
                    <section class="dashboard-item">
                        <h3><i class="fa-brands fa-github" style="margin-right: 8px;"></i>GitHub</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 12px;">
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">API Token</label>
                                <input type="password" id="githubToken" class="input-wide" placeholder="ghp_xxxxxxxxxxxx" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">GitHub personal access token</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Limit</label>
                                <input type="number" id="githubLimit" class="input-compact" min="1" max="100" value="10" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Max results per search</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Timeout (sec)</label>
                                <input type="number" id="githubTimeout" class="input-compact" min="5" max="60" value="20" 
                                    style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                            </div>
                        </div>
                        <div style="margin-top: 12px;">
                            <label style="display: block; margin-bottom: 6px; font-weight: 600;">Keywords (comma-separated)</label>
                            <textarea id="githubKeywords" rows="2" 
                                placeholder="password, apikey, secret, aws_access_key_id, private_key"
                                style="width: 100%; max-width: 600px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;"></textarea>
                        </div>
                        
                        <!-- GitHub How It Works -->
                        <div style="background: #1a1d23; border-left: 3px solid #2ecc71; padding: 12px 16px; margin-top: 16px; border-radius: 4px;">
                            <h4 style="margin: 0 0 8px 0; color: #2ecc71; font-size: 14px;"><i class="fa-solid fa-info-circle" style="margin-right: 6px;"></i>How GitHub Crawler Works</h4>
                            <div style="font-size: 13px; line-height: 1.6; color: #b8bcc4;">
                                <p style="margin: 6px 0;"><strong>Data Collection Method:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li>Uses GitHub Code Search API (api.github.com/search/code)</li>
                                    <li>Searches for configured keywords in public repositories</li>
                                    <li>Queries format: "keyword in:file public:true"</li>
                                    <li>Requires GitHub Personal Access Token (ghp_xxx) for higher rate limits (5,000/hr vs 10/hr unauthenticated)</li>
                                    <li>Respects configurable rate limits between API calls</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Data Extracted:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Repository Info:</strong> Full repository name (owner/repo)</li>
                                    <li><strong>File Path:</strong> Path to file containing keyword match</li>
                                    <li><strong>HTML URL:</strong> Direct link to file on GitHub</li>
                                    <li><strong>Keyword Match:</strong> Which search keyword triggered the result</li>
                                    <li><strong>Entities:</strong> Extracted from snippet - emails, passwords, API keys, tokens</li>
                                    <li><strong>Language:</strong> Detected from file content/snippet</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Classification Process:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li><strong>Keyword Scanning:</strong> Searches for terms like "password", "apikey", "secret", "aws_access_key_id", "private_key"</li>
                                    <li><strong>Entity Extraction:</strong> Parses code snippets for passwords, API keys, tokens, credentials</li>
                                    <li><strong>Asset Matching:</strong> Cross-references extracted data with your watchlist configuration</li>
                                    <li><strong>Hit Scoring:</strong> Counts number of watchlist assets found in the code</li>
                                    <li><strong>Severity Computation:</strong> Calculates risk level based on entity types (API keys = critical, passwords = high, etc.)</li>
                                    <li><strong>Tag Generation:</strong> Auto-tags based on entity types and confidence level</li>
                                    <li><strong>Deduplication:</strong> Stable UID based on repo+path+URL prevents duplicate storage</li>
                                    <li><strong>Content Redaction:</strong> Redacts sensitive values before storing</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Rate Limiting:</strong></p>
                                <ul style="margin: 4px 0 8px 20px; padding: 0;">
                                    <li>Unauthenticated: 10 requests/hour</li>
                                    <li>With Token: 5,000 requests/hour</li>
                                    <li>Configurable delay between searches (default 1500ms)</li>
                                </ul>
                                
                                <p style="margin: 6px 0;"><strong>Best Use Cases:</strong> Finding exposed API keys, hardcoded credentials, accidentally committed secrets, and configuration files with sensitive data in public repositories</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Alerts Configuration -->
                <div id="alerts-tab" class="tab-content">
                    <section class="dashboard-item">
                        <h3>Alert Settings</h3>
                        <p class="muted" style="margin-bottom: 16px;">Configure when and how you receive notifications about critical findings.</p>
                        
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div>
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" id="alertsEnabled" checked style="margin-right: 8px; width: 18px; height: 18px;">
                                    <span style="font-weight: 600;">Enable Automated Alerts</span>
                                </label>
                                <small class="muted" style="margin-left: 26px;">Receive notifications when critical leaks are detected</small>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Alert Threshold</label>
                                <select id="alertThreshold" class="input-compact" 
                                    style="width: 100%; max-width: 300px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                    <option value="critical">Critical Only (Score ≥ 100)</option>
                                    <option value="high">High & Critical (Score ≥ 75)</option>
                                    <option value="medium">Medium & Above (Score ≥ 50)</option>
                                    <option value="low">Low & Above (Score ≥ 25)</option>
                                </select>
                                <small class="muted">Minimum severity level to trigger alerts. <strong>Critical:</strong> Even 1 SSN/password = alert. Lower = more notifications.</small>
                            </div>
                            
                            <div id="batchIntervalSection">
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Batch Check Interval (minutes)</label>
                                <input type="number" id="alertInterval" class="input-compact" min="5" max="1440" value="15" 
                                    style="width: 100%; max-width: 300px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">How often to send batch alert summaries (5-1440 minutes)</small>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Email Notifications</label>
                                <input type="email" id="alertEmail" class="input-wide" placeholder="security@yourcompany.com" 
                                    style="width: 100%; max-width: 600px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Email address to receive alert notifications</small>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 6px; font-weight: 600;">Webhook URL (Optional)</label>
                                <input type="url" id="alertWebhook" class="input-wide" placeholder="https://discord.com/api/webhooks/..." 
                                    style="width: 100%; max-width: 600px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #1a1d23; color: #fff;">
                                <small class="muted">Discord, Slack, or custom webhook URL for JSON POST requests</small>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; margin-top: 24px; flex-wrap: wrap;">
                    <button id="saveConfigBtn" class="btn-primary" style="padding: 10px 24px;">
                        <i class="fa-solid fa-floppy-disk" style="margin-right: 6px;"></i>Save Configuration
                    </button>
                    <button id="resetConfigBtn" class="btn-secondary" style="padding: 10px 24px;">
                        <i class="fa-solid fa-rotate-left" style="margin-right: 6px;"></i>Reset to Defaults
                    </button>
                    <span id="configStatus" class="muted" style="padding: 10px 0;"></span>
                </div>
            </section>
        </main>
    </div>
    <script src="{{ url_for('static', filename='js/config.js') }}"></script>
</body>
</html>
