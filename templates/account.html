<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Homepage with dashboard, resources, and account management for users.">
    <meta name="keywords" content="homepage, dashboard, resources, account, user, web">
    <title>Account Page</title>
    <link rel="stylesheet" href="/dashboard/base.css">
</head>
<body>
     <header>
        <div class="header-flex">
            <div class="logo">
                <img src="../dashboard/logo.png" alt="Site Logo" height="80" width="80" onerror="this.onerror=null;this.src='https://via.placeholder.com/80x80?text=Logo';">
            </div>
            <h1 class="site-heading">Account</h1>
        </div>
        <div class="username-banner" style="text-align:right; margin-top:10px; font-size:1.2em; color:#333;">
            Logged in as: <strong>{{ username }}</strong>
        </div>
    </header>
    <div class="container">
        <aside class="sidebar">
            <button class="logout-btn" onclick="window.location.href='/logout'">Logout</button>
            <nav>
                <ul>
                    <li><a href="{{ url_for('homepage') }}">Home</a></li>
                    <li><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                    <li><a href="{{ url_for('resources_route') }}">Resources</a></li>
                    <li><a href="{{ url_for('account') }}">Account</a></li>
                    <li><a href="{{ url_for('leaks') }}">Leaks</a></li>
                </ul>
            </nav>
        </aside>
        <main>
            <section id="account">
                <h2>Account</h2>
                <section class="account-item">
                    <p>Manage your profile and settings here.</p>
                    <form action="/logout" method="get" style="margin-top: 20px;">
                        <button type="submit" class="logout-btn">Logout</button>
                    </form>
                    <button id="delete-account-btn" class="logout-btn" style="background:#c00; color:#fff; margin-top:20px;">Delete Account</button>
                    <script>
                    document.getElementById('delete-account-btn').onclick = function(e) {
                        e.preventDefault();
                        if (!confirm('Are you sure you want to delete your account? This action cannot be undone.')) return;
                        fetch('/api/account/delete', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                        })
                        .then(res => res.json())
                        .then(data => {
                            if (data.status === 'deleted') {
                                alert('Your account has been deleted.');
                                window.location.href = '/register';
                            } else {
                                alert('Error: ' + (data.message || 'Could not delete account.'));
                            }
                        })
                        .catch(() => alert('Network error. Please try again.'));
                    };
                    </script>
                </section>
            </section>
        </main>
    </div>
</body>
</html>
